# Machine A（4核4G）- app-service 专用
# 部署路径: /opt/dango-ai-code-mother
# 使用方式: docker compose -f docker-compose.app.yml up -d

services:
  app-service:
    build:
      context: ./backend
      dockerfile: Dockerfile.app
    image: dango-ai-code-app:latest
    environment:
      JAVA_OPTS: -Xmx2g -Xms1g
      SPRING_PROFILES_ACTIVE: prod
      NACOS_ADDR: ${NACOS_ADDR}
      NACOS_NAMESPACE: prod
      NACOS_USERNAME: ${NACOS_USERNAME}
      NACOS_PASSWORD: ${NACOS_PASSWORD}
      DUBBO_IP_TO_REGISTRY: ${MACHINE_A_IP}
    volumes:
      - ./logs/app-service:/app/logs/app-service
      - ./app-data/code_output:/app/tmp/code_output
      - ./app-data/code_deploy:/app/tmp/code_deploy
    ports:
      - "8124:8124"
      - "50053:50053"
    restart: unless-stopped
